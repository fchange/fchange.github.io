---
title: 关于一个柔性集群调度机制的实现和优化
date: 2021/10/13
categories: 
 - 随笔
tags: 
 - 云原生
---

# 关于赛题

天池大赛又开始啦，不过这回改名了，叫“云原生编程挑战赛”了，这回有三个题目，我选择了其中的第二个项目：**实现一个柔性集群调度机制**

[2021第二届云原生编程挑战赛2：实现一个柔性集群调度机制-天池大赛-阿里云天池](https://tianchi.aliyun.com/s/a8c27d9b68dc3400cf6616efb68fdf43)

## 题目内容

Apache Dubbo 作为一款可拓展性极高的 RPC 框架，支持高度自定义化的集群调度机制，本次比赛要求参赛者基于 Dubbo 提供的集群调度自定义化能力，辅以调用过滤链机制、自定义负载均衡机制等功能，设计一种柔性调度机制。

一般来说，集群大规模部署可能会遇到这些问题：

首先，由于网络波动或者是机器维护等客观原因，导致部分节点阶段性地不可用。

其次，得益于虚拟化机制，当今云计算的资源利用率可以大幅提高，这会带来诸如虚拟机之间相互争用宿主机资源，部分虚拟机会因此性能显著下降。

而集群的柔性调度正是指 Dubbo 能够从全局的角度合理分配请求，达到集群的自适应。具体来说使消费者能够快速地感知服务端节点性能的随机变化，通过调节发送往不同服务端节点的请求数比例分配变得更加合理，让 Dubbo 即使遇到集群大规模部署带来的问题，也可以提供最优的性能。

# 解题

## 成绩
通过初版的基于窗口的动态监测生产端内存使用率和耗时策略。
目前，我创建的小队，成绩在8795720，目前已经掉到了A榜60名了。

## 解题思路和方向
### 搭建环境
首先便是搭建项目了，这一部分其实是体力活。
 1. 在code.aliyun.com fork 出一份provider-consumer 并clone到本地，用于开发与调试。
 2. clone下来 internal-service项目，internal-service项目依赖provider-consumer提供的调度策略，它默认提供了一个随机的策略。
 3. 按照教程运行 internal-service，打开浏览器 http://localhost:8087/call ，显示OK即表示配置成功。
 4. 使用压测工具来检验性能wrk -t4 -c1024 -d90s -T5 --script=./wrk.lua --latency http://localhost:8087/invoke

### 分析项目
TODO

# 相关图解

# 瓶颈位置

# 优化效果

